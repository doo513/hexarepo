<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>CTF 자동화 테스트</title>
</head>
<body>
    <h1>CTF 문제 자동화 테스트</h1>

    <button onclick="startChallenge()">문제 생성</button>
    <button onclick="stopChallenge()">문제 종료</button>

    <p>
        접속 링크:
        <a id="challenge_link" href="#" target="_blank"></a>
    </p>

    <script>
        function startChallenge() {
            fetch("/start", { method: "POST" })
                .then(response => response.json())
                .then(data => {
                    if (data.url) {
                        alert("문제가 생성되었습니다!\n접속 URL: " + data.url);

                        const link = document.getElementById("challenge_link");
                        link.innerText = data.url;
                        link.href = data.url;
                    } else {
                        alert("문제 생성 실패: " + (data.error || "알 수 없는 오류"));
                    }
                })
                .catch(err => alert("요청 실패: " + err));
        }

        function stopChallenge() {
            fetch("/stop", { method: "POST" })
                .then(response => response.json())
                .then(data => {
                    if (data.status === "ok") {
                        alert("문제 종료 요청 전송됨");
                        const link = document.getElementById("challenge_link");
                        link.innerText = "";
                        link.href = "#";
                    } else {
                        alert("문제 종료 실패: " + (data.error || "알 수 없는 오류"));
                    }
                })
                .catch(err => alert("요청 실패: " + err));
        }
    </script>
</body>
</html>
